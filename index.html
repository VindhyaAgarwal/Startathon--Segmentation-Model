<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Duality AI ¬∑ SegFormer-B2 Desert Segmentation</title>
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- External CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="loading-overlay">
        <div class="loading-box">üîç SEGFORMER-B2 INFERENCE ¬∑ API CALL ¬∑ COLOR SEG</div>
    </div>

    <div class="sidebar">
        <h2>üîπ Duality AI ¬∑ Offroad</h2>
        
        <div class="model-badge">
            üöÄ SegFormer-B2 | Transformer Architecture <span class="api-indicator">API</span>
        </div>

        <!-- Model Info from best.pt -->
        <div class="model-info-card">
            <h4>üìã Model Checkpoint</h4>
            <div class="info-row">
                <span class="info-label">Best IoU:</span>
                <span class="highlight-value" id="bestIou">0.75</span>
            </div>
            <div class="info-row">
                <span class="info-label">Validation IoU:</span>
                <span class="info-value" id="valIou">0.73</span>
            </div>
            <div class="info-row">
                <span class="info-label">Train Loss:</span>
                <span class="info-value" id="trainLoss">0.28</span>
            </div>
            <div class="info-row">
                <span class="info-label">Val Loss:</span>
                <span class="info-value" id="valLoss">0.33</span>
            </div>
            <div class="info-row">
                <span class="info-label">Epoch:</span>
                <span class="info-value" id="epoch">20/20</span>
            </div>
            <div class="info-row">
                <span class="info-label">Best Epoch:</span>
                <span class="info-value" id="bestEpoch">18</span>
            </div>
            <div class="info-row">
                <span class="info-label">Training Time:</span>
                <span class="highlight-value" id="trainTime">1h 02m</span>
            </div>
        </div>

        <div class="model-info-card">
            <h4>‚öôÔ∏è SegFormer Config</h4>
            <div class="info-row">
                <span class="info-label">Backbone:</span>
                <span class="info-value" id="backbone">MiT-B2</span>
            </div>
            <div class="info-row">
                <span class="info-label">Params:</span>
                <span class="info-value" id="params">27.5M</span>
            </div>
            <div class="info-row">
                <span class="info-label">FLOPs:</span>
                <span class="info-value" id="flops">142.8G</span>
            </div>
            <div class="info-row">
                <span class="info-label">Input Size:</span>
                <span class="info-value" id="inputSize">512x512</span>
            </div>
            <div class="info-row">
                <span class="info-label">Decoder:</span>
                <span class="info-value">MLP Layer</span>
            </div>
        </div>

        <div class="upload-section">
            <h3>üì§ Upload Desert Image</h3>
            <label for="fileInput" class="upload-btn">
                + Choose Image
            </label>
            <input type="file" id="fileInput" accept="image/*">
            <div class="file-name" id="fileName">No file selected</div>
            <button class="eval-button" id="predictBtn">üöÄ Run SegFormer Inference</button>
        </div>

        <div class="sidebar-footer">
            best.pt ¬∑ SegFormer-B2 ¬∑ 20 epochs<br>IoU: 0.75 ¬∑ API + Color Segmentation
        </div>
    </div>

    <div class="main">
        <!-- Metrics Cards -->
        <div class="metrics-row">
            <div class="metric-card">
                <div class="label">Mean IoU</div>
                <div class="value" id="meanIou">0.75</div>
            </div>
            <div class="metric-card">
                <div class="label">Base IoU</div>
                <div class="value" id="baseIou">0.26</div>
            </div>
            <div class="metric-card">
                <div class="label">Improvement</div>
                <div class="value" id="improvement">+0.49</div>
            </div>
            <div class="metric-card">
                <div class="label">Inference</div>
                <div class="value" id="inferenceTime">47<span class="unit">ms</span></div>
            </div>
        </div>

        <!-- Segmentation Section -->
        <div class="segmentation-container">
            <h3>üéØ SegFormer-B2 Predictions <span class="training-badge">20 epochs ¬∑ 1h training</span></h3>
            <div class="image-showcase">
                <div class="image-box">
                    <h4>Original Input</h4>
                    <div class="image-preview" id="originalPreview">
                        <span class="placeholder-text">Upload a desert image</span>
                    </div>
                </div>
                <div class="image-box">
                    <h4>SegFormer Segmentation</h4>
                    <div class="image-preview" id="segmentedPreview">
                        <span class="placeholder-text">Results with class colors</span>
                    </div>
                </div>
            </div>
            
            <!-- Class Legend with IoU -->
            <div class="legend-grid" id="classLegend"></div>

            <!-- Stats -->
            <div class="prediction-stats">
                <div class="stat-item">
                    <span class="stat-label">DOMINANT</span>
                    <span class="stat-value" id="dominantClass">‚Äî</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">CONFIDENCE</span>
                    <span class="stat-value" id="confidence">‚Äî</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">CLASSES</span>
                    <span class="stat-value" id="classesDetected">‚Äî</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">API STATUS</span>
                    <span class="stat-value" id="apiStatus">Ready</span>
                </div>
            </div>
        </div>

        <!-- Per-Class Metrics -->
        <div class="chart-grid">
            <div class="chart-card">
                <h3>üìä Per-Class IoU (SegFormer)</h3>
                <div class="chart-canvas-wrapper"><canvas id="perClassIouChart"></canvas></div>
            </div>
            <div class="chart-card">
                <h3>üìà Precision & Recall</h3>
                <div class="chart-canvas-wrapper"><canvas id="precisionRecallChart"></canvas></div>
            </div>
        </div>

        <!-- Detailed Metrics -->
        <div class="metrics-detailed">
            <div class="metric-detailed-card">
                <h4>üìä Performance Metrics</h4>
                <div class="metric-detailed-row">
                    <span>Mean IoU:</span>
                    <span id="detailMeanIou">0.75</span>
                </div>
                <div class="metric-detailed-row">
                    <span>Base IoU:</span>
                    <span id="detailBaseIou">0.26</span>
                </div>
                <div class="metric-detailed-row">
                    <span>Improvement:</span>
                    <span id="detailImprovement">+0.49</span>
                </div>
                <div class="metric-detailed-row">
                    <span>Freq-Weighted IoU:</span>
                    <span id="freqWeightedIou">0.73</span>
                </div>
            </div>
            <div class="metric-detailed-card">
                <h4>üì¶ Dataset Info</h4>
                <div class="metric-detailed-row">
                    <span>Train Samples:</span>
                    <span id="trainSamples">2456</span>
                </div>
                <div class="metric-detailed-row">
                    <span>Val Samples:</span>
                    <span id="valSamples">612</span>
                </div>
                <div class="metric-detailed-row">
                    <span>Classes:</span>
                    <span id="numClasses">10</span>
                </div>
                <div class="metric-detailed-row">
                    <span>Source:</span>
                    <span id="dataSource">Falcon Twin</span>
                </div>
            </div>
            <div class="metric-detailed-card">
                <h4>‚ö° Training Details</h4>
                <div class="metric-detailed-row">
                    <span>GPU:</span>
                    <span id="gpuType">NVIDIA T4</span>
                </div>
                <div class="metric-detailed-row">
                    <span>Train Time:</span>
                    <span id="trainTimeDetail">1h 02m</span>
                </div>
                <div class="metric-detailed-row">
                    <span>Epochs:</span>
                    <span id="epochsDone">20</span>
                </div>
                <div class="metric-detailed-row">
                    <span>Batch Size:</span>
                    <span id="batchSize">16</span>
                </div>
            </div>
        </div>

        <!-- Training Curves (20 epochs) -->
        <div class="chart-card" style="margin-top: 1rem;">
            <h3>üìâ Training Progress (20 epochs ¬∑ 1 hour)</h3>
            <div class="chart-canvas-wrapper" style="height: 250px;">
                <canvas id="trainingChart"></canvas>
            </div>
        </div>
    </div>

    <!-- External JavaScript -->
    <script src="script.js"></script>
</body>
</html>
